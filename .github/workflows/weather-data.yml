name: Run Weather Script and push changes to Repository

# Using Cron tool to schedule the running of the weather.sh script
on:
  schedule:
    - cron: '0 10 * * *'  # Run weather.sh at 10am every day 
  workflow_dispatch:  # Allows me to trigger the script to start manually

# Permissions to push changes back up to my Repository
permissions:
  contents: write 

# Github Action's 1 job with a few steps 
jobs:
# This workflow's job is to Run the weather.sh script
  run-weather-script-and-push-changes-to-Repository:
    runs-on: ubuntu-latest  # Using the latest Ubuntu runner
  
# Step 1: Checking out the repository to make changes to it     
    steps:
    - name: Checkout Repository
      uses: actions/checkout@v3  
    
# Step 2: Set up Python       
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.x'  # Specify the desired Python version

# Step 3: installing any packages needed to run the script & make sure the most up to date version of pip is installed     
    - name: Install Dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt  # Install dependencies

# Run the weather.sh script     
    - name: Run Weather Script
      run: python weather.sh  # Execute the script
 
# Commit changes and push back up to my Repository
    - name: Commit and Push Changes
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  # Use GitHub's automatic token
      run: |
        git config user.name "GitHub Actions"
        git config user.email "actions@github.com"
        git add .
        git commit -m "Run weather.sh and update repository"
        git push
